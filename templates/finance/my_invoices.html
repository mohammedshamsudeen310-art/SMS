{% extends "accounts/base_dashboard.html" %}
{% block title %}My Invoices{% endblock %}
{% block header %}ðŸ’° My Invoices{% endblock %}

{% block content %}
<style>
/* ====== My Invoices Styling ====== */
.invoice-section {
  background: #ffffff;
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  animation: fadeIn 0.5s ease-in-out;
}

.invoice-section h2 {
  font-size: 1.5rem;
  color: #2d3748;
  font-weight: 700;
  margin-bottom: 1rem;
  text-align: center;
}

/* ðŸ”¹ Scrollable Table Wrapper */
.table-responsive {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border-radius: 10px;
}

/* ====== Table Design ====== */
.invoice-table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 10px;
  overflow: hidden;
  min-width: 800px; /* Prevents cramping on mobile */
}

.invoice-table thead {
  background: #3182ce;
  color: white;
}

.invoice-table th,
.invoice-table td {
  padding: 12px 16px;
  border-bottom: 1px solid #e2e8f0;
  text-align: left;
  white-space: nowrap;
}

.invoice-table tbody tr:hover {
  background: #f7fafc;
}

/* ====== Status Badges ====== */
.status-paid {
  color: #38a169;
  font-weight: bold;
}

.status-pending {
  color: #d69e2e;
  font-weight: bold;
}

.status-unpaid {
  color: #e53e3e;
  font-weight: bold;
}

/* ====== Download Button ====== */
.download-btn {
  background: #3182ce;
  color: #fff;
  padding: 6px 12px;
  border-radius: 6px;
  text-decoration: none;
  font-size: 0.9rem;
  font-weight: 600;
  transition: background 0.2s;
  white-space: nowrap;
}

.download-btn:hover {
  background: #2b6cb0;
}

/* ====== Animation ====== */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ====== ðŸ“± Mobile Tweaks ====== */
@media (max-width: 768px) {
  .invoice-section {
    padding: 16px;
  }
  .invoice-section h2 {
    font-size: 1.3rem;
  }
  .invoice-table th, .invoice-table td {
    padding: 10px;
    font-size: 13px;
  }
}
</style>

<div class="invoice-section">
  <h2>My Invoices</h2>

  <div class="table-responsive">
    <table class="invoice-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Invoice ID</th>
          <th>Session</th>
          <th>Term</th>
          <th>Total Due (â‚µ)</th>
          <th>Paid (â‚µ)</th>
          <th>Balance (â‚µ)</th>
          <th>Status</th>
          <th>Date Issued</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for invoice in invoices %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ invoice.invoice_number }}</td>
          <td>{{ invoice.session }}</td>
          <td>{{ invoice.term }}</td>
          <td>{{ invoice.total_due }}</td>
          <td>{{ invoice.total_paid }}</td>
          <td>{{ invoice.balance }}</td>
          <td>
            {% if invoice.is_paid %}
              <span class="status-paid">Paid</span>
            {% elif invoice.total_paid > 0 %}
              <span class="status-pending">Partially Paid</span>
            {% else %}
              <span class="status-unpaid">Unpaid</span>
            {% endif %}
          </td>
          <td>{{ invoice.date_issued|date:"M d, Y" }}</td>
          <td>
            <a href="{% url 'download_invoice_pdf' invoice.id %}" class="download-btn">Download PDF</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="10" style="text-align:center; color:#718096;">No invoices found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
